#include <stdio.h>
#include <stdarg.h>
#include <math.h>
#include <Windows.h>

typedef enum {
    SUCCESS = 0,
    INCORRECT_NUMBER_INPUT,
    INCORRECT_ARGUMENTS_COUNT_INPUT,
    INCORRECT_FLAG_INPUT,
    INCORRECT_NUMBER_ARGUMENTS_INPUT,
    FILE_OPENING_ERROR,
    FILE_READING_ERROR,
    FILE_WRITING_ERROR,
    FILE_CLOSING_ERROR,
    UNKNOWN_ERROR
} ErrorCode;

static const char* errorMessages[] = {
        "Всё хорошо",
        "Некорректный ввод числа кол-ва аргументов, попробуйте ещё раз",
        "Некорректный ввод числа, попробуйте ещё раз",
        "Некорректный ввод флага, попробуйте ещё раз",
        "Некорректное кол-во аргументов, попробуйте ещё раз",
        "Ошибка открытия файла",
        "Ошибка чтения файла",
        "Ошибка записи файла",
        "Ошибка закрытия файла",
        "Неизвестная ошибка, что-то пошло не так"
};

#define foo(X) _Generic((X), \
    int: foo_int, \
    double: foo_double, \
    char *: foo_charptr \
)(X)

double power(double x, int n) {
    if (n == 0) {
        return 1.0;
    } else if (n % 2 == 0) {
        double half = power(x, n / 2);
        return half * half;
    } else {
        double half = power(x, (n - 1) / 2);
        return x * half * half;
    }
}

double averageGeometric(int n, ...) {
    if(n < 1) return 0.0;

    va_list args;
    va_start(args, n);

    double product = 1.0;

    for (int i = 0; i < n; i++) {
        double num = va_arg(args, double);
        product *= num;
    }

    va_end(args);

    double average = pow(product, 1.0 / n);
    return average;
}

int main() {
    SetConsoleCP(1251);
    SetConsoleOutputCP(1251);

    int arguments_count = 3;

    double averageGeometric_result = averageGeometric(arguments_count, 2.0, 3.0, 3.0);
    printf("Среднее геометрчиеское: %f\n", averageGeometric_result);

    double base = 2.0;
    int exponent = 5;

    double power_result = power(base, exponent);
    printf("%f в степени %d = %f\n", base, exponent, power_result);

    return SUCCESS;
}
